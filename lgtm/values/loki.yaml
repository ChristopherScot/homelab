loki:
  deploymentMode: SingleBinary

  persistence:
    enabled: true
    storageClassName: longhorn
    accessModes:
    - ReadWriteOnce
    size: 50Gi # Adjust based on your retention needs

  # Define schema and chunk storage configuration
  schemaConfig:
    configs:
    - from: 2024-01-01
      store: tsdb
      object_store: filesystem
      schema: v13
      index:
        prefix: loki_index_
        period: 24h

  storage:
    type: 'filesystem'

  storage_config:
    tsdb_shipper:
      active_index_directory: '/var/loki/tsdb-index'
      cache_location: '/var/loki/tsdb-cache'
      cache_ttl: 24h


  # Component-specific configurations
  distributor:
    replicas: 1
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 256Mi

  ingester:
    replicas: 2
    resources:
      requests:
        cpu: 200m
        memory: 512Mi
      limits:
        cpu: 500m
        memory: 1Gi

  querier:
    replicas: 2
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi

  queryFrontend:
    replicas: 1
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 256Mi

  compactor:
    replicas: 1
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 256Mi

  # Disable IAM and cloud-related settings
  commonConfig:
    replication_factor: 1
  limits_config:
    allow_ingester_out_of_order_writes: false
    retention_period: 672h # 28 days retention

